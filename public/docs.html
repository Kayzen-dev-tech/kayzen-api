<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Kayzen API Docs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #f4f6f9; color: #333; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* Sidebar Styles */
        .sidebar { height: 100vh; position: fixed; top: 0; left: 0; width: 260px; background: #fff; padding: 20px; overflow-y: auto; border-right: 1px solid #ddd; z-index: 1000; }
        .content { margin-left: 260px; padding: 40px; }
        
        /* Card Styles */
        .endpoint-card { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-left: 5px solid #ddd; transition: 0.2s; }
        .endpoint-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        /* Methods Colors */
        .method { font-weight: bold; padding: 5px 10px; border-radius: 4px; font-size: 0.8rem; margin-right: 10px; text-transform: uppercase; width: 60px; text-align: center; display: inline-block; }
        .get { background: #e7f5ff; color: #007bff; border: 1px solid #b3d7ff; }
        .post { background: #e8f5e9; color: #28a745; border: 1px solid #c3e6cb; }
        
        .endpoint-card.card-get { border-left-color: #007bff; }
        .endpoint-card.card-post { border-left-color: #28a745; }

        /* Url Code */
        code { color: #d63384; font-size: 0.95rem; word-break: break-all; }
        
        /* Interactive Elements */
        .input-group-custom { margin-top: 15px; }
        .form-control-sm { border-radius: 20px; }
        .btn-try { border-radius: 20px; padding: 5px 20px; font-size: 0.9rem; }
        
        /* Response Box */
        .response-box { 
            background: #1e1e1e; 
            color: #00d4ff; 
            padding: 15px; 
            border-radius: 8px; 
            margin-top: 15px; 
            display: none; /* Hidden by default */
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            max-height: 400px;
            overflow-y: auto;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; border-bottom: 1px solid #ddd; }
            .content { margin-left: 0; padding: 20px; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h4 class="mb-4 fw-bold text-primary"><i class="fas fa-code"></i> Kayzen API</h4>
        <a href="/" class="d-block mb-3 text-decoration-none text-secondary"><i class="fas fa-arrow-left"></i> Kembali ke Home</a>
        <div class="list-group list-group-flush">
            <a href="#dramadash" class="list-group-item list-group-item-action border-0 rounded mb-1">Drama & Movie</a>
            <a href="#downloader" class="list-group-item list-group-item-action border-0 rounded mb-1">Downloader</a>
            <a href="#tools" class="list-group-item list-group-item-action border-0 rounded mb-1">Tools & AI</a>
            <a href="#muslim" class="list-group-item list-group-item-action border-0 rounded mb-1">Muslim Features</a>
            <a href="#stalk" class="list-group-item list-group-item-action border-0 rounded mb-1">Stalking</a>
            <a href="#uploader" class="list-group-item list-group-item-action border-0 rounded mb-1">Uploader</a>
            <a href="#search" class="list-group-item list-group-item-action border-0 rounded mb-1">Search</a>
            <a href="#anime" class="list-group-item list-group-item-action border-0 rounded mb-1">Anime</a>
        </div>
    </div>

    <div class="content">
        <h1 class="fw-bold">Dokumentasi API & Playground</h1>
        <p class="lead text-secondary">Klik tombol "Try" untuk mencoba API langsung di halaman ini.</p>

        <h3 id="dramadash" class="mt-5">Drama & Movie</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/dramadash/home</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/dramadash/search?q=query</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/dramadash/detail?id=drama_id</code></div>
        
        <h3 id="downloader" class="mt-5">Downloader</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/download/tiktok?url=tiktok_url</code><p class="small text-muted mt-1">No Watermark</p></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/download/youtube?url=yt_url</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/ig/download?url=instagram_url</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/download/spotify?url=music_url</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/download/twitter-dl?url=twitter_url</code></div>

        <h3 id="tools" class="mt-5">Tools & AI</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/ai/meta-ai?prompt=text</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/translate/sunda?text=kalimat</code></div>
        
        <div class="endpoint-card card-post">
            <span class="method post">POST</span> <code>/api/tools/imagetoascii</code>
            <p class="small text-muted mt-1">Upload gambar untuk diubah ke ASCII</p>
        </div>
        
        <div class="endpoint-card card-post">
            <span class="method post">POST</span> <code>/api/tools/removebg</code>
            <p class="small text-muted mt-1">Upload gambar untuk hapus background</p>
        </div>

        <h3 id="muslim" class="mt-5">Muslim Features</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/muslim/jadwalsholat?kota=jakarta</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/muslim/ask?q=pertanyaan</code></div>

        <h3 id="stalk" class="mt-5">Stalking</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/stalk/ig?username=user</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/stalk/tiktok?username=user</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/stalk/twitter?username=user</code></div>

        <h3 id="uploader" class="mt-5">Uploader</h3>
        <div class="endpoint-card card-post">
            <span class="method post">POST</span> <code>/api/upload/videy</code>
            <p class="small text-muted mt-1">Upload file ke Videy.co</p>
        </div>
        <div class="endpoint-card card-post">
            <span class="method post">POST</span> <code>/api/upload/top4top</code>
            <p class="small text-muted mt-1">Upload file ke Top4top</p>
        </div>

        <h3 id="search" class="mt-5">Search</h3>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/search/spotify?q=query</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/search/google-image?q=query</code></div>
        <div class="endpoint-card card-get"><span class="method get">GET</span> <code>/api/search/google-video?q=query</code></div>

        <h3 id="anime" class="mt-5">Anime</h3>
        <div class="endpoint-card card-get">
            <span class="method get">GET</span> <code>/api/anime/random?type=waifu</code>
            <p class="small text-muted mt-1">Random anime images. Type: waifu (default), neko, atau loli</p>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const cards = document.querySelectorAll('.endpoint-card');

            cards.forEach((card, index) => {
                const methodSpan = card.querySelector('.method');
                const codeBlock = card.querySelector('code');
                const fullUrlText = codeBlock.innerText;
                const method = methodSpan.innerText.trim();

                const [endpoint, paramsString] = fullUrlText.split('?');
                
                const formContainer = document.createElement('div');
                formContainer.className = 'input-group-custom';
                
                let inputsHtml = '';
                const inputsList = [];

                if (method === 'GET' && paramsString) {
                    const params = paramsString.split('&');
                    params.forEach(param => {
                        const [key, placeholder] = param.split('=');
                        const inputId = `input-${index}-${key}`;
                        inputsList.push({ id: inputId, key: key });
                        
                        // Special handling for anime random type parameter
                        if (key === 'type' && endpoint.includes('/api/anime/random')) {
                            inputsHtml += `
                                <div class="mb-2">
                                    <label class="small fw-bold text-secondary">${key}</label>
                                    <select id="${inputId}" class="form-select form-control-sm">
                                        <option value="waifu">waifu</option>
                                        <option value="neko">neko</option>
                                        <option value="loli">loli</option>
                                    </select>
                                </div>`;
                        } else {
                            inputsHtml += `
                                <div class="mb-2">
                                    <label class="small fw-bold text-secondary">${key}</label>
                                    <input type="text" id="${inputId}" class="form-control form-control-sm" placeholder="Masukkan ${key}...">
                                </div>`;
                        }
                    });
                } 
                else if (method === 'POST') {
                    const inputId = `input-file-${index}`;
                    inputsList.push({ id: inputId, key: 'file', type: 'file' });
                    let fieldName = 'image';
                    if(endpoint.includes('videy') || endpoint.includes('top4top')) fieldName = 'file';

                    inputsHtml += `
                        <div class="mb-2">
                            <label class="small fw-bold text-secondary">Upload File (${fieldName})</label>
                            <input type="file" id="${inputId}" class="form-control form-control-sm">
                            <input type="hidden" id="field-name-${index}" value="${fieldName}">
                        </div>`;
                }

                inputsHtml += `
                    <button class="btn btn-primary btn-sm btn-try mt-2" onclick="executeRequest(${index}, '${method}', '${endpoint}')">
                        <i class="fas fa-play me-1"></i> Test Endpoint
                    </button>
                    <div id="response-${index}" class="response-box">Waiting for response...</div>
                `;

                formContainer.innerHTML = inputsHtml;
                card.appendChild(formContainer);
            });
        });

        async function executeRequest(index, method, endpoint) {
            const responseBox = document.getElementById(`response-${index}`);
            responseBox.style.display = 'block';
            responseBox.innerText = 'Loading...';
            
            try {
                let url = endpoint;
                let body = null;
                let headers = {};

                if (method === 'GET') {
                    const inputs = document.querySelectorAll(`[id^='input-${index}-']`);
                    const queryParams = [];
                    inputs.forEach(input => {
                        if (input.value) {
                            const key = input.id.split('-').pop(); 
                            queryParams.push(`${key}=${encodeURIComponent(input.value)}`);
                        }
                    });
                    if (queryParams.length > 0) {
                        url += '?' + queryParams.join('&');
                    }
                } 
                
                else if (method === 'POST') {
                    const fileInput = document.getElementById(`input-file-${index}`);
                    const fieldName = document.getElementById(`field-name-${index}`).value;
                    
                    if (fileInput.files.length > 0) {
                        const formData = new FormData();
                        formData.append(fieldName, fileInput.files[0]);
                        body = formData;
                    } else {
                        responseBox.innerText = 'Error: Pilih file terlebih dahulu!';
                        return;
                    }
                }

                const res = await fetch(url, {
                    method: method,
                    body: body
                });

                const data = await res.json();
                responseBox.innerText = JSON.stringify(data, null, 2);

            } catch (error) {
                responseBox.innerText = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
